model == "res4" ~ value
)
)
}
) %>%
map(
.,
ineff_summary
) %>%
map2(
.,
countries,
function(x,y){
x %>%
mutate(country = y) %>%
relocate(country)
}
) %>%
bind_rows()
summary_school_inefficiencies_mean <- map(
countries,
suffering_ineff,
data = results,
r = 'technical_inefficiency'
) %>%
map(
.,
function(x){
x %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
}
) %>%
map(
.,
ineff_summary
) %>%
map2(
.,
countries,
function(x,y){
x %>%
mutate(country = y) %>%
relocate(country)
}
) %>%
bind_rows()
summary_school_inefficiencies %>%
write_rds('stats/summary_inefficiencies')
summary_school_inefficiencies
summary_school_inefficiencies <- map(
countries,
suffering_ineff,
data = results,
r = 'technical_inefficiency'
) %>%
map(
.,
function(x){
x %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
}
) %>%
map(
.,
ineff_summary
) %>%
map2(
.,
countries,
function(x,y){
x %>%
mutate(country = y) %>%
relocate(country)
}
) %>%
bind_rows()
summary_school_inefficiencies %>%
write_rds('stats/summary_inefficiencies')
summary_school_inefficiencies
results
results %>% filter(country == "svk" & result == 'lamda')
results %>% filter(country == "svk" & result == 'lamda')%>%
select(res1:res4) %>%
list() %>%
flatten() %>%
flatten() %>%
results %>% filter(country == "svk" & result == 'lamda')%>%
select(res1:res4) %>%
list() %>%
flatten() %>%
flatten()
results %>% filter(country == "svk" & result == 'lamda')%>%
list() %>%
flatten()
results
results %>%
filter(
results == 'lamda'
)
results %>%
filter(
result == 'lamda'
)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4))
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
unnest(res1, res2)
source("~/Projects/PISA/stats/analysis.R", echo=TRUE)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value)
################################################################################
rep(c("z1", "z2"), 8)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(name)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = name)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = result)
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = result) %>%
rename(name = "model")
results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = result) %>%
rename(model = "name")
summary_lamda <- results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = result) %>%
rename(model = "name")
summary_school_inefficiencies %>%
write_rds('stats/summary_inefficiencies.rds')
summary_lamda <- results %>%
filter(
result == 'lamda'
) %>%
select(- c(res3, res4)) %>%
pivot_longer(res1:res2) %>%
unnest(value) %>%
mutate(
result = rep(c("z1", "z2"), 8)
) %>%
relocate(country) %>%
pivot_wider(names_from = result) %>%
rename(model = "name")
summary_lamda %>%
write_rds("stats/summary_lamda.rds")
results
results %>%
filter(result == "technical_inefficiency")
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4) %>%
unnest(value)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4) %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model")
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
mutate(
value = map(
value,
function(x){
x %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
}
)
)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model")
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1")
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1") %>%
select(value)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1") %>%
select(value) %>%
unnest()
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1") %>%
select(value)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1") %>%
select(value) %>%
flatten()
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
filter(country == "svk" & model == "res1") %>%
select(value) %>%
flatten()
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
# filter(country == "svk" & model == "res1") %>%
# select(value) %>%
# flatten()
mutate(
value = map(
value,
function(x){
x %>%
flatten() %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
}
)
)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model")
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
results %>%
filter(result == "technical_inefficiency") %>%
pivot_longer(res1:res4, names_to = "model")
results %>%
filter(result == "technical_inefficiency") %>%
select(-result) %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
results %>%
filter(result == "technical_inefficiency") %>%
select(-result) %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
) %>%
group_by(country, model) %>%
nest(value)
results %>%
filter(result == "technical_inefficiency") %>%
select(-result) %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
) %>%
group_by(country, model) %>%
nest(value) %>%
mutate(
p = map(
data,
function(x){
ecdf(x)
}
)
)
results %>%
filter(result == "technical_inefficiency") %>%
select(-result) %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
tmp <- results %>%
filter(result == "technical_inefficiency") %>%
select(-result) %>%
pivot_longer(res1:res4, names_to = "model") %>%
unnest(value) %>%
mutate(
value = case_when(
model == "res1" ~ 2 - value,
model == "res2" ~ 2 - value,
model == "res3" ~ value,
model == "res4" ~ value
)
)
filter(tmp, country == "svk", model = "res1")
filter(tmp, country == "svk" & model == "res1")
ecdf(filter(tmp, country == "svk" & model == "res1"))
ecdf(filter(tmp, country == "svk" & model == "res1") %>% pull(value))
# ecdf(filter(tmp, country == "svk" & model == "res1") %>% pull(value))
tmp %>%
group_by(country, model) %>%
nest(value) %>%
mutate(
p = map(
data,
function(x){
x %>%
pull(value) %>%
ecdf(.)
}
)
)
# ecdf(filter(tmp, country == "svk" & model == "res1") %>% pull(value))
tmp %>%
group_by(country, model) %>%
nest(value) %>%
mutate(
p = map(
data,
function(x){
x %>%
pull(value) %>%
ecdf(.)
}
)
) %>%
unnest(p)
all_ results <- read_rds('modeling/results/all_models.rds')
all_results <- read_rds('modeling/results/all_models.rds')
all_results
library(reticulate)
reticulate::use_condaenv("papyr2", required = T)
py_run_file(file = "modeling/call_py_objects.py")
py_run_file(file = "modeling/call_py_objects.py")
py_run_file(file = "modeling/call_py_objects.py")
reticulate::repl_python()
